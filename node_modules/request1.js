
var cheerio = require('cheerio');
var request = require('request');
var db1 = require('db');

module.exports = {

crawl : function(site,brand){
global.products_arr = new Array();
global.specs_arr = new Array();
switch(site){

case 'GSM':

switch(brand){

case 'nokia':
request('http://www.gsmarena.com/nokia-phones-1.php',function(err,response,html){

var $ = cheerio.load(html);
var makers = $('div.makers ul li');

makers.each(function(index,el){


var makers_link = makers.eq(index).find('a').eq(0).attr('href');
//console.log(global.products_arr);
global.products_arr.push(makers_link);
//console.log(makers_link+'<br/>');


request('http://gsmarena.com/'+makers_link,function(err,response,html){

var $ = cheerio.load(html);
var table = $("div#specs-list table").eq(0).children('tr').eq(0).text();
//console.log(table+'<br/>');

global.specs_arr.push(table);

});


});


setTimeout(function(){


global.products_arr.forEach(function(el,index,err){

var specs_name = global.specs_arr[index];
console.log(global.specs_arr[index]);
//db1 = db1.add_product('','','','','',);

});

},50000)
});
break;

}

break;
}



}


}